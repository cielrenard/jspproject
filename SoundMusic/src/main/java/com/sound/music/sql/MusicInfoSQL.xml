<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC 
				"-//mybatis.org//DTD Mapper 3.0//EN" 
				"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="musicinfo">
	<!-- 01. 음악 리스트 만들기 -->
	<select id="listinfo" parameterType="com.sound.music.vo.MusicInfoVO" resultType="com.sound.music.vo.MusicInfoVO">
		SELECT 
				*
		FROM	
			(SELECT
				MU_NO AS no,
				MU_TITLE AS title,
				MU_ARTIST AS artist,
				MU_ALBUM AS album,
				MU_GENRE AS genre,
				MU_IMAGEPATH AS path,
				MU_STAR AS star,
				ROW_NUMBER() OVER(ORDER BY MU_STAR ASC) AS rno
			 FROM
				MUSIC
			 WHERE
				UPPER(MU_ISSHOW)='Y'
				<if test="genre != ''">
					AND MU_GENRE = #{genre}
				</if>
				)
		WHERE 
			rno BETWEEN #{start} AND #{end}
	</select>			
	<!-- 02. 음악 상세정보조회  -->
	<select id="minfo" parameterType="int" resultType="com.sound.music.vo.MusicInfoVO">
		SELECT 
			MU_NO as no,
			MU_TITLE as title,
			MU_ARTIST as artist,
			MU_ALBUM as album,
			MU_IMAGEPATH as path,
			MU_GENRE as genre,
			MU_LYRICS as lyrics,
			MU_STAR as star
		FROM
			MUSIC
		WHERE
			MU_ISSHOW='Y'
		AND 
			MU_NO = #{no}	
	</select>
	<!-- 03. 페이징처리를 위한 음악 개수 구하기 -->
	<select id ="totalCount" resultType="int">
		SELECT
			COUNT(*) as cnt
		FROM
			MUSIC
		WHERE 
			MU_ISSHOW='Y'	
	</select>					
</mapper>				